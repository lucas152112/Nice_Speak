# 開發計劃 (DEVELOPMENT_PLAN.md)

## 專案資訊

| 項目 | 內容 |
|------|------|
| **專案名稱** | Nice_Speak |
| **App 名稱** | Nice Speak |
| **版本** | v1.0.0 |
| **預估工期** | 12 週 |

---

## 開發階段總覽

| 階段 | 名稱 | 週數 | 主要任務 |
|------|------|------|----------|
| **Phase 1** | 基礎建設 | 2 週 | 專案初始化 + 資料庫 + 認證 |
| **Phase 2** | 情境系統 | 2 週 | 情境 API + 前端頁面 |
| **Phase 3** | 語音系統 | 2 週 | STT/TTS + 對話流程 |
| **Phase 4** | AI 評估 | 2 週 | 評估 API + 分數計算 |
| **Phase 5** | 等級系統 | 1 週 | 等級計算 + 進度追蹤 |
| **Phase 6** | 訂閱系統 | 2 週 | 支付整合 + 訂閱管理 |
| **Phase 7** | 整合測試 | 1 週 | 整合測試 + 上線準備 |

---

## Phase 1：基礎建設 (第 1-2 週)

### 目標
- 建立前後端專案結構
- 完成資料庫設計
- 實作 JWT 認證系統

### 任務清單

| # | 任務 | 描述 | 依賴 | 狀態 |
|---|------|------|------|------|
| 1.1 | 建立 GitHub Repo | 建立遠端倉庫 | - | ⏳ |
| 1.2 | 初始化 Flutter 專案 | 建立 mobile/ 目錄 | - | ⏳ |
| 1.3 | 初始化 Nuxt.js 3 專案 | 建立 web/ 目錄 | - | ⏳ |
| 1.4 | 初始化 Rust 後端 | 建立 backend/ 目錄 | - | ⏳ |
| 1.5 | i18n 架構設定 | Flutter + Nuxt.js 多語系框架 | 1.2, 1.3 | ⏳ |
| 1.6 | 正體中文語系檔 | 建立 zh_TW 翻譯檔 | 1.5 | ⏳ |
| 1.7 | 資料庫遷移腳本 | 建立 MySQL 8 表結構 | 1.4 | ⏳ |
| 1.8 | 後端配置管理 | config.rs 實作 | 1.4 | ⏳ |
| 1.9 | JWT 認證模組 | 登入/註冊/Token 刷新 | 1.4, 1.7 | ⏳ |
| 1.10 | 用戶 CRUD API | 個人資料管理 | 1.9 | ⏳ |
| 1.11 | 設備綁定 API | 設備識別 + 防濫用機制 | 1.7 | ⏳ |
| 1.12 | 前端 API 服務層 | Axios + API 封裝 | 1.2, 1.3 | ⏳ |
| 1.13 | 前端認證頁面 | 登入/註冊頁面 | 1.12, 1.10 | ⏳ |
| 1.14 | 設備綁定頁面 | 設備檢查 + 導向登入 | 1.11, 1.12 | ⏳ |

### 單元測試範圍

| # | 測試項目 | 測試內容 |
|---|----------|----------|
| 1.9.1 | JWT 產生 | Token 格式驗證 |
| 1.9.2 | JWT 驗證 | Token 有效性檢查 |
| 1.9.3 | 密碼加密 | bcrypt 雜湊比對 |
| 1.10.1 | 用戶創建 | 必填欄位驗證 |
| 1.10.2 | 用戶查詢 | 權限檢查 |

### Phase 1 交付物
- [ ] GitHub Repo 建立完成
- [ ] 前端可運行
- [ ] i18n 架構完成 (正體中文)
- [ ] 用戶可註冊/登入
- [ ] 單元測試通過率 > 80%

---

## Phase 2：情境系統 (第 3-4 週)

### 目標
- 實作情境 API
- 建立情境管理後台
- 完成前端情境瀏覽頁面

### 任務清單

| # | 任務 | 描述 | 依賴 | 狀態 |
|---|------|------|------|------|
| 2.1 | 情境資料模型 | Scenario/Dialogue 結構 | P1 | ⏳ |
| 2.2 | 情境 API - 列表 | 取得情境列表 | P1 | ⏳ |
| 2.3 | 情境 API - 詳情 | 取得情境內容 | 2.2 | ⏳ |
| 2.4 | 情境 API - 篩選 | 分類/難度/角色過濾 | 2.2 | ⏳ |
| 2.5 | 單字資料模型 | Vocabulary 結構 | P1 | ⏳ |
| 2.6 | 單字 API | 單字查詢 | 2.5 | ⏳ |
| 2.7 | 前端情境列表 | 卡片式列表頁面 | P1 | ⏳ |
| 2.8 | 前端情境詳情 | 對話預覽頁面 | 2.3 | ⏳ |
| 2.9 | 前端單字顯示 | 單字卡片元件 | 2.6 | ⏳ |
| 2.10 | 前端路由配置 | Vue Router 設定 | P1 | ⏳ |

### 單元測試範圍

| # | 測試項目 | 測試內容 |
|---|----------|----------|
| 2.2.1 | 情境列表 | 分頁驗證 |
| 2.2.2 | 情境列表 | 權限過濾 |
| 2.3.1 | 情境詳情 | 404 錯誤處理 |
| 2.4.1 | 篩選功能 | 多條件組合 |
| 2.6.1 | 單字搜尋 | 模糊查詢 |

### Phase 2 交付物
- [ ] 情境 API 完整
- [ ] 前端可瀏覽情境
- [ ] 單元測試通過率 > 80%

---

## Phase 3：語音系統 (第 5-6 週)

### 目標
- 整合 STT/TTS 服務
- 實作對話流程
- 建立 WebSocket 即時通訊

### 任務清單

| # | 任務 | 描述 | 依賴 | 狀態 |
|---|------|------|------|------|
| 3.1 | STT 服務整合 | 語音轉文字 API | P2 | ⏳ |
| 3.2 | TTS 服務整合 | 文字轉語音 API | P2 | ⏳ |
| 3.3 | WebSocket 服務 | 即時對話通道 | P1 | ⏳ |
| 3.4 | 練習開始 API | 建立練習會話 | 2.2 | ⏳ |
| 3.5 | 語音提交 API | 接收音頻 + STT | 3.1, 3.3 | ⏳ |
| 3.6 | Flutter 錄音模組 | 語音錄製功能 | P1 | ⏳ |
| 3.7 | Flutter TTS 播放 | 語音播放功能 | P1 | ⏳ |
| 3.8 | Vue WebRTC 錄音 | 瀏覽器錄音 | P1 | ⏳ |
| 3.9 | 對話頁面 UI | 即時對話介面 | 2.7, 2.8 | ⏳ |
| 3.10 | 語音控制 | 錄音/播放/停止 | 3.6, 3.7 | ⏳ |

### 單元測試範圍

| # | 測試項目 | 測試內容 |
|---|----------|----------|
| 3.1.1 | STT 轉換 | 文字準確度 |
| 3.2.1 | TTS 生成 | 音頻有效性 |
| 3.3.1 | WebSocket 連線 | 心跳機制 |
| 3.5.1 | 音頻提交 | 格式驗證 |

### Phase 3 交付物
- [ ] STT/TTS 可用
- [ ] 可進行對話練習
- [ ] 單元測試通過率 > 80%

---

## Phase 4：AI 評估 (第 7-8 週)

### 目標
- 整合 AI 評估服務
- 實作分數計算
- 建立錯誤記錄

### 任務清單

| # | 任務 | 描述 | 依賴 | 狀態 |
|---|------|------|------|------|
| 4.1 | AI 評估 API | GPT-4/Claude 整合 | P3 | ⏳ |
| 4.2 | 發音評估 | 發音分數計算 | 4.1 | ⏳ |
| 4.3 | 語法評估 | 語法分數計算 | 4.1 | ⏳ |
| 4.4 | 用詞評估 | 用詞分數計算 | 4.1 | ⏳ |
| 4.5 | 流暢度評估 | 流暢度分數計算 | 4.1 | ⏳ |
| 4.6 | 評估結果 API | 回傳完整評分 | 4.2-4.5 | ⏳ |
| 4.7 | 練習記錄 API | 儲存練習結果 | P3 | ⏳ |
| 4.8 | 錯誤日誌 API | 記錄錯誤句子 | P3 | ⏳ |
| 4.9 | 前端評估顯示 | 分數卡片元件 | 4.6 | ⏳ |
| 4.10 | 前端反饋顯示 | AI 建議顯示 | 4.6 | ⏳ |

### 單元測試範圍

| # | 測試項目 | 測試內容 |
|---|----------|----------|
| 4.2.1 | 發音分數 | 邊界值測試 (0-30) |
| 4.3.1 | 語法分數 | 邊界值測試 (0-30) |
| 4.4.1 | 用詞分數 | 邊界值測試 (0-20) |
| 4.5.1 | 流暢度分數 | 邊界值測試 (0-20) |
| 4.6.1 | 總分計算 | 加總正確性 |

### Phase 4 交付物
- [ ] AI 評估可用
- [ ] 分數計算正確
- [ ] 單元測試通過率 > 80%

---

## Phase 5：等級系統 (第 9 週)

### 目標
- 實作等級計算
- 建立進度追蹤
- 實作升級邏輯

### 任務清單

| # | 任務 | 描述 | 依賴 | 狀態 |
|---|------|------|------|------|
| 5.1 | 等級計算服務 | 0-10 級計算 | P4 | ⏳ |
| 5.2 | 升級判斷 | 連續/累計達標 | 5.1 | ⏳ |
| 5.3 | 折扣計算 | 80%/60% 折扣 | 5.1 | ⏳ |
| 5.4 | 等級 API | 取得用戶等級 | 5.1 | ⏳ |
| 5.5 | 進度 API | 練習進度查詢 | P4 | ⏳ |
| 5.6 | 前端等級顯示 | 等級進度條 | 5.4 | ⏳ |
| 5.7 | 前端統計儀表板 | 練習統計 | 5.5 | ⏳ |
| 5.8 | 升級彈窗 | 升級通知 UI | 5.2 | ⏳ |
| 5.9 | 錯誤複習 API | 錯誤清單查詢 | P4 | ⏳ |
| 5.10 | 錯誤複習頁面 | 複習介面 | 5.9 | ⏳ |

### 單元測試範圍

| # | 測試項目 | 測試內容 |
|---|----------|----------|
| 5.1.1 | 等級計算 | 分數邊界測試 |
| 5.2.1 | 連續達標 | 3 次條件判斷 |
| 5.2.2 | 累計達標 | 6 次條件判斷 |
| 5.3.1 | 折扣計算 | 5 級/10 級判斷 |

### Phase 5 交付物
- [ ] 等級系統完整
- [ ] 進度追蹤可用
- [ ] 單元測試通過率 > 80%

---

## Phase 6：訂閱系統 (第 10-11 週)

### 目標
- 整合支付系統
- 實作訂閱管理
- 建立權限控制

### 任務清單

| # | 任務 | 描述 | 依賴 | 狀態 |
|---|------|------|------|------|
| 6.1 | 訂閱方案 API | 取得方案列表 | P1 | ⏳ |
| 6.2 | 訂閱購買 API | 建立訂單 | P5 | ⏳ |
| 6.3 | 支付整合 | 綠界科技/Stripe | 6.2 | ⏳ |
| 6.4 | 訂閱狀態 API | 查詢訂閱狀態 | 6.1 | ⏳ |
| 6.5 | 訂閱過期處理 | 自動降級 | 6.4 | ⏳ |
| 6.6 | 權限檢查 Middleware | 訂閱權限 | P1 | ⏳ |
| 6.7 | 前端訂閱頁面 | 方案選擇 UI | 6.1 | ⏳ |
| 6.8 | 前端支付流程 | 付款介面 | 6.3 | ⏳ |
| 6.9 | 前端訂閱管理 | 訂閱狀態顯示 | 6.4 | ⏳ |
| 6.10 | 試用期管理 | 3天/7天邏輯 | P1 | ⏳ |

### 單元測試範圍

| # | 測試項目 | 測試內容 |
|---|----------|----------|
| 6.1.1 | 方案列表 | 價格顯示正確 |
| 6.2.1 | 訂單建立 | 訂單號生成 |
| 6.4.1 | 訂閱狀態 | 過期判斷 |
| 6.6.1 | 權限檢查 | 未訂閱拒絕 |

### Phase 6 交付物
- [ ] 支付系統可用
- [ ] 訂閱管理完整
- [ ] 單元測試通過率 > 80%

---

## Phase 7：整合測試 (第 12 週)

### 目標
- 整合測試執行
- 效能測試
- 上線準備

### 任務清單

| # | 任務 | 描述 | 依賴 | 狀態 |
|---|------|------|------|------|
| 7.1 | API 整合測試 | 全 API 測試 | P1-P6 | ⏳ |
| 7.2 | 前端整合測試 | E2E 測試 | P1-P6 | ⏳ |
| 7.3 | 效能測試 | 負載測試 | 7.1 | ⏳ |
| 7.4 | 安全測試 | 滲透測試 | 7.1 | ⏳ |
| 7.5 | 文件更新 | API 文件更新 | P1-P6 | ⏳ |
| 7.6 | 部署腳本 | Docker 設定 | P1-P6 | ⏳ |
| 7.7 | 上線檢查清單 | Release Checklist | 7.1-7.6 | ⏳ |

### 整合測試項目

| # | 測試項目 | 描述 |
|---|----------|------|
| T1 | 完整註冊流程 | 註冊 → 登入 → 個人設定 |
| T2 | 情境練習流程 | 選擇 → 練習 → 評估 → 結果 |
| T3 | 等級晉升流程 | 多次練習 → 升級通知 |
| T4 | 訂閱購買流程 | 選擇方案 → 支付 → 訂閱成功 |
| T5 | 錯誤複習流程 | 錯誤 → 複習 → 掌握 |
| T6 | 權限控制流程 | 免費版 → 升級 → 解鎖功能 |

### Phase 7 交付物
- [ ] 所有測試通過
- [ ] 部署腳本完成
- [ ] 上線準備就緒

---

## 測試覆蓋率標準

| 類型 | 最低覆蓋率 |
|------|------------|
| 單元測試 | 80% |
| 整合測試 | 100% 關鍵流程 |
| E2E 測試 | 6 大流程 |

---

## 開發任務追蹤表

### 符號說明

| 符號 | 意義 |
|------|------|
| ⏳ | 待執行 |
| 🔄 | 執行中 |
| ✅ | 已完成 |
| ❌ | 已阻擋 |

### 總覽

| 階段 | 任務數 | 完成 | 進行中 | 待執行 |
|------|--------|------|--------|--------|
| Phase 1 | 10 | 0 | 0 | 10 |
| Phase 2 | 10 | 0 | 0 | 10 |
| Phase 3 | 10 | 0 | 0 | 10 |
| Phase 4 | 10 | 0 | 0 | 10 |
| Phase 5 | 10 | 0 | 0 | 10 |
| Phase 6 | 10 | 0 | 0 | 10 |
| Phase 7 | 7 | 0 | 0 | 7 |
| **總計** | **67** | **0** | **0** | **67** |

---

## 風險評估

| 風險 | 影響 | 機率 | 對策 |
|------|------|------|------|
| STT/TTS 延遲 | 高 | 中 | 快取 + 預載 |
| AI API 成本 | 高 | 中 | 限流 + 優化 |
| 支付整合延遲 | 中 | 低 | 提前對接 |
| 效能瓶頸 | 中 | 中 | 水平擴展 |

---

## 里程碑

| 日期 | 里程碑 |
|------|--------|
| Week 2 | Phase 1 完成 |
| Week 4 | Phase 2 完成 |
| Week 6 | Phase 3 完成 |
| Week 8 | Phase 4 完成 |
| Week 9 | Phase 5 完成 |
| Week 11 | Phase 6 完成 |
| Week 12 | Phase 7 完成 + 上線 |

---

**版本**: v1.0.0  
**建立日期**: 2024-XX-XX  
**最後更新**: 2024-XX-XX
